<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="jmj00@ucsb.edu" />


<title>02: Interactive Data Viz</title>

<script src="site_libs/jquery-1.12.4/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/clipboard-1.7.1/clipboard.min.js"></script>
<link href="site_libs/primer-tooltips-1.4.0/build.css" rel="stylesheet" />
<link href="site_libs/klippy-0.0.0.9500/css/klippy.min.css" rel="stylesheet" />
<script src="site_libs/klippy-0.0.0.9500/js/klippy.min.js"></script>
<script src="site_libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="site_libs/datatables-binding-0.13/datatables.js"></script>
<link href="site_libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="site_libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="site_libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="site_libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">COVID-19 Dashboard</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-book"></span>
     
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="00_setting_up_the_project.html">Setting COVID-19 Dashboard Project</a>
    </li>
    <li>
      <a href="01_getting_data.html">Getting Data</a>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Interactive Plots</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="02_graphs.html">Graphs</a>
        </li>
        <li>
          <a href="03_maps.html">Maps</a>
        </li>
        <li>
          <a href="04_tables.html">Tables</a>
        </li>
      </ul>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Building Shiny</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="05_shiny_basics.html">Basics</a>
        </li>
        <li>
          <a href="06_shiny_maps.html">Adding your Map</a>
        </li>
        <li>
          <a href="07_shiny_graph.html">Adding Your Graph</a>
        </li>
        <li>
          <a href="08_shiny_table.html">Adding Your Table</a>
        </li>
        <li>
          <a href="09_autocomplete.html">Auto-Complete Searchbar</a>
        </li>
      </ul>
    </li>
    <li>
      <a href="10_publish.html">Publish your Dashboard</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">02: Interactive Data Viz</h1>
<h3 class="subtitle">Tables</h3>
<h4 class="author"><a href="mailto:jmj00@ucsb.edu" class="email">jmj00@ucsb.edu</a></h4>

</div>


<script>
  addClassKlippyTo("pre.r, pre.markdown");
  addKlippy('right', 'top', 'auto', '1', 'Copy code', 'Copied!');
</script>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co">## Load our helper file with our functions</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">source</span>(<span class="st">&#39;./helpers.R&#39;</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co">## Load the county data</span></span>
<span id="cb1-5"><a href="#cb1-5"></a>counties =<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;./data/counties.rds&quot;</span>)</span>
<span id="cb1-6"><a href="#cb1-6"></a></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co">## Use our functions! from section 1:</span></span>
<span id="cb1-8"><a href="#cb1-8"></a>covid19 =<span class="st"> </span><span class="kw">read_covid19</span>(<span class="st">&#39;https://raw.githubusercontent.com/nytimes/covid-19-data/master/us-counties.csv&#39;</span>)</span>
<span id="cb1-9"><a href="#cb1-9"></a>today =<span class="st"> </span><span class="kw">today_centroids</span>(counties, covid19)</span></code></pre></div>
<p>The <code>DT</code> package provides an R interface to the JavaScript library DataTables. R data objects (matrices or data frames) can be displayed as tables on HTML pages, and DataTables provides filtering, pagination, sorting, and many other features in the tables. Documentation and examples for DT can be found <a href="https://rstudio.github.io/DT/">here</a></p>
<p>The objective of this section is to build a function called <code>make_table</code> that takes a FIP code and build a nice summary table of information. We are going to look at two options. The first, will return a table of all counties in the same state as the selected FIP code. The second is a bit more complicated (and optional!) but will scape Wikipedia to get information about the county. Lets take a look at these options!</p>
<div id="option-1-sorting-a-table-by-state-counts" class="section level2">
<h2>Option 1: Sorting a Table by state &amp; counts</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co">#Intial FIPS</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>FIP =<span class="st"> </span><span class="dv">6037</span></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co"># Fitler today&#39;s data to the FIP</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>myfip  =<span class="st"> </span><span class="kw">filter</span>(today, fips <span class="op">==</span><span class="st"> </span>FIP)</span>
<span id="cb2-5"><a href="#cb2-5"></a></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="co"># Filter todays data to the state of the input FIP</span></span>
<span id="cb2-7"><a href="#cb2-7"></a>mydata =<span class="st"> </span><span class="kw">filter</span>(today, state <span class="op">==</span><span class="st"> </span>myfip<span class="op">$</span>state) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="co"># Arrange the cases from largest to smallest</span></span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(cases)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="co"># Drop the geometry column</span></span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="st">  </span><span class="kw">st_drop_geometry</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb2-12"><a href="#cb2-12"></a><span class="co"># Keep the  County name, cases and deaths</span></span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="st">  </span><span class="kw">select</span>(<span class="dt">County =</span> county, <span class="dt">Cases =</span> cases, <span class="dt">Deaths =</span> deaths) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb2-14"><a href="#cb2-14"></a><span class="co"># Create a new variable called Death Rate</span></span>
<span id="cb2-15"><a href="#cb2-15"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">DeathRate =</span> <span class="kw">paste0</span>(<span class="dv">100</span><span class="op">*</span><span class="st"> </span><span class="kw">round</span>(Deaths<span class="op">/</span>Cases,<span class="dv">2</span>), <span class="st">&quot;%&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb2-16"><a href="#cb2-16"></a><span class="st">  </span><span class="kw">head</span>(<span class="dv">20</span>)</span>
<span id="cb2-17"><a href="#cb2-17"></a></span>
<span id="cb2-18"><a href="#cb2-18"></a></span>
<span id="cb2-19"><a href="#cb2-19"></a><span class="co"># Make an interactive Table! with a caption</span></span>
<span id="cb2-20"><a href="#cb2-20"></a><span class="kw">datatable</span>(mydata, <span class="dt">caption =</span> <span class="kw">paste</span>(<span class="st">&#39;COVID-19 Statistics&#39;</span>, myfip<span class="op">$</span>state, myfip<span class="op">$</span>date), <span class="dt">options =</span> <span class="kw">list</span>(<span class="dt">paging =</span> <span class="ot">FALSE</span>, <span class="dt">searching =</span> <span class="ot">FALSE</span>)) </span></code></pre></div>
<div id="htmlwidget-96c6b94191e884fa799b" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-96c6b94191e884fa799b">{"x":{"filter":"none","caption":"<caption>COVID-19 Statistics California 2020-05-07<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20"],["Los Angeles","Riverside","San Diego","Orange","San Bernardino","Santa Clara","Alameda","San Francisco","San Mateo","Kern","Sacramento","Contra Costa","Tulare","Fresno","Santa Barbara","Ventura","San Joaquin","Stanislaus","Imperial","Solano"],[29427,4756,4492,3156,2562,2281,1938,1806,1377,1133,1132,999,969,813,722,631,581,461,455,347],[1418,194,186,66,108,122,69,32,56,14,49,29,43,9,11,19,28,17,8,7],["5%","4%","4%","2%","4%","5%","4%","2%","4%","1%","4%","3%","4%","1%","2%","3%","5%","4%","2%","2%"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>County<\/th>\n      <th>Cases<\/th>\n      <th>Deaths<\/th>\n      <th>DeathRate<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"paging":false,"searching":false,"columnDefs":[{"className":"dt-right","targets":[2,3]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="option-2-scraping-wikipedia-data" class="section level2">
<h2>Option 2: Scraping Wikipedia Data</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">library</span>(rvest)</span>
<span id="cb3-2"><a href="#cb3-2"></a></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co"># Filter the input data to the input FIP code</span></span>
<span id="cb3-4"><a href="#cb3-4"></a>county_here =<span class="st"> </span><span class="kw">filter</span>(today, fips <span class="op">==</span><span class="st"> </span>FIP)</span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="co"># Build a Wikipedia URL using the data attribute &#39;name&#39;</span></span>
<span id="cb3-6"><a href="#cb3-6"></a>url =<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&#39;https://en.wikipedia.org/wiki/&#39;</span>,  <span class="kw">gsub</span>(<span class="st">&quot; &quot;</span>, <span class="st">&quot;_&quot;</span>, county_here<span class="op">$</span>name))</span>
<span id="cb3-7"><a href="#cb3-7"></a>  <span class="co"># Steps:</span></span>
<span id="cb3-8"><a href="#cb3-8"></a>  <span class="co">## 1. Read the HTML from the URL</span></span>
<span id="cb3-9"><a href="#cb3-9"></a>  <span class="co">## 2. Read the Nodes from the HTML page and select the table with a class infobox</span></span>
<span id="cb3-10"><a href="#cb3-10"></a>  <span class="co">## 3. Convert raw HTML node to a data.frame</span></span>
<span id="cb3-11"><a href="#cb3-11"></a>links &lt;-<span class="st"> </span><span class="kw">read_html</span>(url) <span class="op">%&gt;%</span></span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="st">           </span><span class="kw">html_nodes</span>(<span class="st">&quot;table.infobox&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb3-13"><a href="#cb3-13"></a><span class="st">           </span><span class="kw">html_table</span>(<span class="dt">fill=</span> <span class="ot">TRUE</span>) </span>
<span id="cb3-14"><a href="#cb3-14"></a></span>
<span id="cb3-15"><a href="#cb3-15"></a></span>
<span id="cb3-16"><a href="#cb3-16"></a><span class="co">## Make a datatable from the resulting data.frame and turn off paging</span></span>
<span id="cb3-17"><a href="#cb3-17"></a><span class="kw">datatable</span>(links[[<span class="dv">1</span>]],  <span class="dt">caption =</span> <span class="kw">paste</span>(<span class="st">&#39;Wikipedia Information:&#39;</span>, county_here<span class="op">$</span>name), </span>
<span id="cb3-18"><a href="#cb3-18"></a>              <span class="dt">options =</span> <span class="kw">list</span>(<span class="dt">paging =</span> <span class="ot">FALSE</span>, <span class="dt">searching =</span> <span class="ot">FALSE</span>, <span class="dt">ordering =</span> <span class="ot">FALSE</span>))</span></code></pre></div>
<div id="htmlwidget-3c763f865a947a01820f" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-3c763f865a947a01820f">{"x":{"filter":"none","caption":"<caption>Wikipedia Information: Los Angeles County, California<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40"],["County","County of Los Angeles","Images, from top down, left to right: Downtown Los Angeles in June 2019; Venice, Los Angeles during sunset; Rodeo Drive in Beverly Hills; satellite picture of Santa Catalina Island; the Santa Monica Pier; Angeles National Forest; Vasquez Rocks; Antelope Valley California Poppy Reserve; and the Hollywood Sign","FlagSeal","Nickname(s): \"L.A. County\"","Location of the county in California","California's location in the United States","Coordinates: 34°3′N 118°15′W﻿ / ﻿34.050°N 118.250°W﻿ / 34.050; -118.250Coordinates: 34°3′N 118°15′W﻿ / ﻿34.050°N 118.250°W﻿ / 34.050; -118.250","Country","State","Region","Metro area","Formed","Named for","County seat","Largest city","Incorporated cities","Government","• Type","• Body","• Board of Supervisors[2]","• Chief executive officer","Area","• Total","• Land","• Water","Highest elevation[3]","Lowest elevation[4]","Population (2010)[5]","• Total","• Estimate (2019)[5]","• Density","Time zone","• Summer (DST)","ZIP Codes","Area codes","FIPS code","GNIS feature ID","GDP","Website"],["County","County of Los Angeles","Images, from top down, left to right: Downtown Los Angeles in June 2019; Venice, Los Angeles during sunset; Rodeo Drive in Beverly Hills; satellite picture of Santa Catalina Island; the Santa Monica Pier; Angeles National Forest; Vasquez Rocks; Antelope Valley California Poppy Reserve; and the Hollywood Sign","FlagSeal","Nickname(s): \"L.A. County\"","Location of the county in California","California's location in the United States","Coordinates: 34°3′N 118°15′W﻿ / ﻿34.050°N 118.250°W﻿ / 34.050; -118.250Coordinates: 34°3′N 118°15′W﻿ / ﻿34.050°N 118.250°W﻿ / 34.050; -118.250","United States","California","Southern California","Greater Los Angeles","February 18, 1850[1]","The City of Los Angeles, which was named for Our Lady, Queen of the Angels","Los Angeles","Los Angeles","88","Government","Council–manager","Board of Supervisors","Supervisors\nHilda SolisMark Ridley-ThomasSheila KuehlJanice HahnKathryn Barger","Sachi A. Hamai","Area","4,751 sq mi (12,310 km2)","4,058 sq mi (10,510 km2)","693 sq mi (1,790 km2)","10,068 ft (3,069 m)","0 ft (0 m)","Population (2010)[5]","9,818,605","10,039,107","2,100/sq mi (800/km2)","UTC−8 (Pacific Time Zone)","UTC−7 (Pacific Daylight Time)","90xxx–918xx, 92397, 92821, 92823, 93243, 935xx[6]","213/323, 310/424, 442/760, 562, 626, 657/714, 661, 747/818, 840/909","06-037","277283","$711 billion[7] · 1st","www.lacounty.gov"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Los Angeles County<\/th>\n      <th>Los Angeles County<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"paging":false,"searching":false,"ordering":false,"order":[],"autoWidth":false,"orderClasses":false,"columnDefs":[{"orderable":false,"targets":0}]}},"evals":[],"jsHooks":[]}</script>
<p>Lets add all of these to the helper.R file which looks something like:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>make_table =<span class="st"> </span><span class="cf">function</span>(today, FIPS){</span>
<span id="cb4-2"><a href="#cb4-2"></a>  county_here =<span class="st"> </span><span class="kw">filter</span>(today, fips <span class="op">==</span><span class="st"> </span>FIP)</span>
<span id="cb4-3"><a href="#cb4-3"></a></span>
<span id="cb4-4"><a href="#cb4-4"></a>  url =<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&#39;https://en.wikipedia.org/wiki/&#39;</span>,  <span class="kw">gsub</span>(<span class="st">&quot; &quot;</span>, <span class="st">&quot;_&quot;</span>, county_here<span class="op">$</span>name)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="st">           </span><span class="kw">read_html</span>(url) <span class="op">%&gt;%</span></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="st">           </span><span class="kw">html_nodes</span>(<span class="st">&quot;table.infobox&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="st">           </span><span class="kw">html_table</span>(<span class="dt">fill=</span> <span class="ot">TRUE</span>) </span>
<span id="cb4-8"><a href="#cb4-8"></a></span>
<span id="cb4-9"><a href="#cb4-9"></a>  l =<span class="st"> </span>links[[<span class="dv">1</span>]]</span>
<span id="cb4-10"><a href="#cb4-10"></a>  ll =<span class="st"> </span>l[<span class="op">!</span>l[,<span class="dv">1</span>] <span class="op">==</span><span class="st"> </span>l[,<span class="dv">2</span>],]</span>
<span id="cb4-11"><a href="#cb4-11"></a></span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="co">## Make a datatable from the resulting data.frame and turn off paging</span></span>
<span id="cb4-13"><a href="#cb4-13"></a>  <span class="kw">datatable</span>(ll,  <span class="dt">caption =</span> <span class="kw">paste</span>(<span class="st">&#39;Wikipedia Information:&#39;</span>, county_here<span class="op">$</span>name), </span>
<span id="cb4-14"><a href="#cb4-14"></a>              <span class="dt">options =</span> <span class="kw">list</span>(<span class="dt">paging =</span> <span class="ot">FALSE</span>, <span class="dt">searching =</span> <span class="ot">FALSE</span>, <span class="dt">ordering =</span> <span class="ot">FALSE</span>))</span>
<span id="cb4-15"><a href="#cb4-15"></a>}</span></code></pre></div>
<p>A complete <code>helpers.R</code> file can be found <a href="https://github.com/mikejohnson51/COVID-19-dashboard/blob/master/helpers.R">here</a> for download / copy-paste.</p>
<p>Notice that all the visualization functions we have built rely on our <code>county</code>, <code>timeseries</code>, or <code>today</code> data and a usr defined <code>FIP code</code>. From these we can make informative plots, maps and tables.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode numberSource r numberLines lineAnchors"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># Base Example</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>map =<span class="st"> </span><span class="kw">basemap</span>(today)</span>
<span id="cb5-3"><a href="#cb5-3"></a></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="kw">zoom_to_county</span>(map, couties, <span class="dv">6037</span>)</span>
<span id="cb5-5"><a href="#cb5-5"></a></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="kw">make_table</span>(today, <span class="dv">6037</span>)</span>
<span id="cb5-7"><a href="#cb5-7"></a></span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="kw">make_graph</span>(covid19, <span class="dv">6037</span>)</span></code></pre></div>
<p>The purpose of our Shiny Application will be to display these resoruces on a common page, and allow user input (from sources like clicks and text-input) to change the FIP code and the resulting visualizations. To do this we need a speacial type of programing known as ‘reative’.</p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
